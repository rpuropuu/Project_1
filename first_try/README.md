![](https://img.shields.io/badge/Python-3.9-blue)
![](https://img.shields.io/badge/tensorflow-2.4.1-blue)
![](https://img.shields.io/badge/NumPy-1.19.5-blue)
![](https://img.shields.io/badge/matplotlib-3.2.2-blue)
![](https://img.shields.io/badge/cv2-4.1.2-blue)
![](https://img.shields.io/badge/scikit-0.22.2.post1-blue)


__________


Пример построения свёрточной нейронной сети. Задача которой - локализация двух животных. Из соображений этики, полное условие задания не публикуется. Здесь будет описан только процесс получения рабочего результата. Все файлы будут доступны в пронумерованном порядке.


_________


### ПЛАН
1. Обучение нейросети различать два класса.
    - исследование вводных данных
    - поиск методов достижения результата исходя из заданных условий (малая выборка)
    - подготовка скриптов для обработки данных
2. Сохранение для последующего дообучения.
    - нюансы совместимости сетей
3. Обучение второй нейросети по предобученным моделям
    - подбор методов оптимизации для конвеерного тестирования стратегий
    - Transfer Learning c VGG16
    - Transfer Learning cо своей обученной нейронной сетью в п. 1
4. Обзор статистики
    - создание дополнительных скриптов вывода обработанных данных
    - проведение требуемых замеров для отчёта
5. Оформление
    - подготовка изображений с информацией
    - составление легенды
    - статистика, оформленная в соответствии с заданием
    - README-файл на гитхабе
6. Овервью

________


1. В датасете оказалось всего **3385** изображений, который были разделены на два класса с большой разницей в соотношении: **1037** изборажений кошек и **2348** изображений собак. Всё это ещё было разбито на **80%** обучения и **20%** валидации рандомным скриптом - **2708** против **677**. А для тестовой выборки я загружал файлы из интернета. При добавлении дополнительных опций в слои аугментации, неросеть начинала показывать результаты ещё хуже. Различные придуманные мной варианты не приводили к особой стабилизации процесса обучения, уже потом, после того, когда я полностью всю сеть доделал через VGG, я вернулся к этому варианту. выкачал из интернета датасет на кошек и собак, и дополнил оба класса до **4 000 штук в каждом**. Наилучшим результатом первого поколения стал результат с **89%**, однако, он оказался не совместим со второй частью нейронной сети. Сейчас удалось переделать и обучиться на **86%**. И уже с этой моделью я обучал вторую часть нейронки искать лица животных. Этот вариант превосходит первый по определению класса, и работает на порядок быстрее, чем c VGG, но уступает в точности отрисовки боксов. _Я планирую разметить боксами обновленный датасэт и уже на нём продолжать дальнейшие эксперементы по оптимизации, ввиду ограниченности сроков выполнения задания._
2. Почти все задания на каггле, и не только тут, решаются через бинарную архитектуру, соответственно вывод подготавливается сигмоидальной функцией. Однако, для возможности классифицировать объекты, даже если их всего два, необходимо уже использовать категориальную кросэнтропию с возможностью вывода через софтамакс на два нейрона, что позволит совместить обучаемость со второй частю нейронной сети.
3. К выбору архитектуры второй нейросети я уже подходил более осознанно. Я понимал, что желательно наличие какго-либо конфига, для возможности быстрого переключения между стратегиями, а также системой логов. Решил сразу привыкать к удобному управлению через, _а вдруг Линукс_. Судя по тенденциям в сообществе, профилактика использования Transfer Learning приветствуется, а значит и используемая архитектура должна быть максимально близка к модульности, даже в пространстве понимания новчика.
4. Из различных логовых файлов собирается статистика в одну строку для просмотра результатов работы сети по тестовой выборке. Если класс совпадает с предсказанным сетью, то метка класса - **зелёная**, иначе - **красная**. Коэфициэнт **mIoU** выводится в левом верхнем углу. Зона предсказания выводится **синим** цветом. Сначала три примера со средним коэфициентом попадания:


![](https://github.com/rpuropuu/Project_1/blob/main/first_try/data/01.jpg)
![](https://github.com/rpuropuu/Project_1/blob/main/first_try/data/03.jpg)
![](https://github.com/rpuropuu/Project_1/blob/main/first_try/data/02.jpg)


Далее два варианта с малым коэфициентом:


![](https://github.com/rpuropuu/Project_1/blob/main/first_try/data/05.jpg)
![](https://github.com/rpuropuu/Project_1/blob/main/first_try/data/04.jpg)


И четыре хороших коэфициэнта:


![](https://github.com/rpuropuu/Project_1/blob/main/first_try/data/08.jpg)
![](https://github.com/rpuropuu/Project_1/blob/main/first_try/data/07.jpg)
![](https://github.com/rpuropuu/Project_1/blob/main/first_try/data/09.jpg)
![](https://github.com/rpuropuu/Project_1/blob/main/first_try/data/06.jpg)


И четыре ошибочно классифицированные варианта:


![](https://github.com/rpuropuu/Project_1/blob/main/first_try/data/11.jpg)
![](https://github.com/rpuropuu/Project_1/blob/main/first_try/data/12.jpg)
![](https://github.com/rpuropuu/Project_1/blob/main/first_try/data/10.jpg)
![](https://github.com/rpuropuu/Project_1/blob/main/first_try/data/13.jpg)


Итоговая статистика по работе только с предоставленным датасетом и с использованием VGG в роли классифицирующего слоя:

```
> mIoU 57%, classification accuracy 91%, 0.13ms, 2708 train,676 valid.
```

Один файл на валидации повреждён, вычтен из статистики. При вызове предикта на один файл, время выполнения может выростать до 0.3ms.

6. Обдумываю как сюда оформить статистику по второму варианту нейросети **без VGG**. Ещё сам не знаю какие там будут цифры. Большое спасибо за предоставленную возможность познакомится с нейросетями, ещё две недели назад я о них только слУшал. И планировал я ими заняться может через год-два.
